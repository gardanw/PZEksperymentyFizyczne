{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="{% static 'experiments/css/home.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'experiments/css/mrowki.css' %}">
    <title>Mrowki</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
        plansza = function (k) {
            var kratki = parseInt($(k).val());
            console.log(parseInt($(k).val()))
            var bok = parseInt(800 / kratki);
            for (let i = 0; i < kratki; i++) {
                for (let j = 0; j < kratki; j++) {
                    let newRect = document.createElementNS('http://www.w3.org/2000/svg', "rect");
                    newRect.setAttribute("x", `${i * bok}`);
                    newRect.setAttribute("y", `${j * bok}`);
                    newRect.setAttribute("width", `${bok}`);
                    newRect.setAttribute("height", `${bok}`);
                    newRect.setAttribute("fill", "black");
                    newRect.setAttribute("id", `${i}-${j}`);
                    document.getElementById('pole').appendChild(newRect)
                }
            }
        }


        $(document).ready(function () {
            plansza($('.display'))
            var kratki = $('.display').val()

            var zmiana_ruchu = {
                "R": {'(0, -1)': [-1, 0], '(-1, 0)': [0, 1], '(0, 1)': [1, 0], '(1, 0)': [0, -1]},
                "L": {'(0, -1)': [1, 0], '(1, 0)': [0, 1], '(0, 1)': [-1, 0], '(-1, 0)': [0, -1]},
            }
            var pos = [parseInt(kratki / 2), parseInt(kratki / 2)]
            var kierunek_ruchu = [0, 1]

            ruch = function () {
                if (document.getElementById(`${pos[0]}-${pos[1]}`).getAttribute("fill") === 'black') {
                    document.getElementById(`${pos[0]}-${pos[1]}`).setAttribute("fill", "white");
                    kierunek_ruchu = zmiana_ruchu["R"][`(${kierunek_ruchu[0]}, ${kierunek_ruchu[1]})`];
                    pos[0] = pos[0] + kierunek_ruchu[0];
                    pos[1] = pos[1] + kierunek_ruchu[1];
                } else {
                    document.getElementById(`${pos[0]}-${pos[1]}`).setAttribute("fill", "black");
                    kierunek_ruchu = zmiana_ruchu["L"][`(${kierunek_ruchu[0]}, ${kierunek_ruchu[1]})`];
                    pos[0] = pos[0] + kierunek_ruchu[0];
                    pos[1] = pos[1] + kierunek_ruchu[1];
                }
                if (pos[0] == -1){
                    pos[0] = kratki - 1
                }
                if(pos[0] == kratki){
                    pos[0] = 0
                }
                if (pos[1] == -1){
                    pos[1] = kratki - 1
                }
                if(pos[1] == kratki){
                    pos[1] = 0
                }

            }

            var intervalId;
            $('#start').on('click', function () {
                clearInterval(intervalId);
                intervalId = setInterval(ruch, 5);
            });

            $('#stop').on('click', function () {
                clearInterval(intervalId);
            })

            $('#reset').on('click', function () {
                clearInterval(intervalId);
                $('#pole').empty();
                plansza($('.display'));
                kratki = $('.display').val()
                pos = [parseInt(kratki / 2), parseInt(kratki / 2)]
                kierunek_ruchu = [0, 1]
            });
        })


    </script>
</head>
<body>
<div class="header">
    <div class="inner_header">
        <div class="logo_container">
            <h1>Mr&#243;wki<span>LANGTONA</span></h1>
        </div>
        <ol class="navigation">
            <li><a href="/">Home</a></li>
            <li><a href="/experiments/">Eksperymenty</a>
                {% if eksperymenty %}
                <ul class="exp_menu">
                    {% for eksperyment in eksperymenty %}
                    <li><a href="/experiments/{{eksperyment.exp_name}}">
                        {{ eksperyment.full_name }}
                    </a></li>
                    {% endfor %}
                </ul>
                {% endif %}
            </li>
            <li><a href="">O projekcie</a></li>
        </ol>
    </div>
</div>
<input class='display' value="15"/>
<input id="start" type="button" value="start">
<input id="stop" type="button" value="stop">
<input id="reset" type="button" value="reset">
<div class="plansza">
    <svg id="pole" viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg">

    </svg>
</div>

</body>
</html>